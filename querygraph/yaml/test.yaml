DATABASES:
  mo_seasons:
    TYPE: sqlite
    HOST: C:\Users\pete\Packaged Projects\querygraph\querygraph\db\sample_data\flights.db
  daily_ts:
    TYPE: sqlite
    HOST: host: C:\Users\pete\Packaged Projects\querygraph\querygraph\db\sample_data\carriers.db
QUERY_NODES:
  mo_seasons:
      DATABASE: mo_seasons
      QUERY: |
        SELECT *
        FROM month_seasons
        WHERE season IN {% seasons|value_list:str %}
  daily_ts:
    DATABASE: daily_ts
    PARENT_NODE: mo_seasons
    QUERY: |
      SELECT *
      FROM daily_ts
      WHERE month_name IN {{ [datetime.to_str(str.to_datetime(str.capitalize(month), format='%b'), format='%B')]|value_list:str }}
    JOIN_CONTEXT:
      HOW: inner
      ON:
        - daily_ts.month_abr: mo_seasons.month
    MANIPULATION_SET:
      - CREATE:
        - month_abr: str.lowercase(str.slice(month_name, s=0, e=4))